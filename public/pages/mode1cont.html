<!DOCTYPE html>

  <html>

    <head>
      <title>Drawing Robot Mode 1</title>
      <meta charset="utf-8">
      <link rel="stylesheet" type="text/css" href="../styles/style.css">
    </head>

    <body>

      <header>
        <div class="container">
          <div class="logo">
            <img src="../styles/logo.jpg" alt="Drawbot Logo">
          </div>
          <nav class="navigation-top">
            <ul>
              <li><a href="../index.html" class="nav-link">Home</a></li>
              <li><a href="#" class="nav-link">Mode1</a></li>
              <li><a href="mode2cont.html" class="nav-link">Mode2</a></li>
              <li><a href="showcase.html" class="nav-link">Showcase</a></li>
            </ul>

            <div class="dropdown">
              <button class="button-dropdown">Menu</button>
              <div class="dropdown-content">
                <a href="../index.html">Home</a>
                <a href="mode2cont.html">Mode 2</a>
                <a href="showcase.html">Showcase</a>
              </div>
            </div>
          </nav>
        </div>
      </header>


      <div class = "mode1_title">
        <h1>MODE 1</h1> <!--formate??-->
      </div>
      
      <section class="mode-1-sub" id="Mode1">
        <script>
          function printShape(shape) {
          document.getElementById("demo").innerHTML = shape;
          }
        </script>
        <div class="option1">
          <h2>① Choose one shape below:</h2>
          <div class="shapes"> <!--option1-->
            <input type="image" src="../styles/shape_square.jpg" class = "block" onclick="printShape('SQUARE')"> 
        
            <input type="image" src="../styles/shape_triangle.jpg" class = "block" onclick="printShape('TRIANGLE')"> 
       
            <input type="image" src="../styles/shape_circle.jpg" class = "block" onclick="printShape('CIRCLE')"> 
            <br>

            <input type="image" src="../styles/shape_rectangle.jpg" class = "block" onclick="printShape('RECTANGLE')"> 
  
            <input type="image" src="../styles/shape_heart.jpg" class = "block" onclick="printShape('HEART')"> 

            <input type="image" src="../styles/shape_oval.jpg" class = "block" onclick="printShape('OVAL')"> 

          </div>
          <div class = "shape_text">
            <p>You've chosen: </p>
            <p id="demo"></p>
          </div>
        </div>

        <div class="option2">
          <h2>② Enter your text below: </h2> <!--option2 title-->
          <div class="chatbox">
            <canvas id="canvas" width="500" height="300"></canvas>
            <label for="fname"> <br> Input text:</label>
            <input type="text" id="content" placeholder="Enter content max length 40" maxlength="40">
            <button type="button" id="submit">submit</button>
            <button type="button" id="clear">clear</button>
          </div>
          <script>
            var al;
            var Wrapper = {
              width: 50,
              height: 50,
              images: [],
              bgColor: '#cba3e9',
              getElement(id) {
                var element = document.getElementById(id);
                if (element) {
                  return element;
                }
                element = document.getElementsByName(id);
                if (element) {
                  return element[0];
                }
                element = document.getElementsByClassName(id);
                if (element) {
                  return element;
                }
                element = document.getElementsByTagName(id);
                if (element) {
                  return element[0];
                }
                return null;
              },
              fillText(ctx, text) {
                text = /^[a-zA-Z]*$/.test(text) ? text.toLocaleUpperCase() : text;
                ctx.fillStyle = 'white';
                ctx.font = "30px Arial";
                //ctx.translate(20, 50);
                ctx.fillText(text, 20, 50);
              },
              drawImage(text) {
                var canvas = document.createElement('canvas');
                var ctx = canvas.getContext('2d');
                var image = new Image();
                var imageIndex = Math.floor(Math.random() * 10);
                var url = this.images[imageIndex];
                image.src = url;
            
                canvas.width = this.width;
                canvas.height = this.height;
                var self = this;
                var self = this;
                return new Promise(function (resolve) {
                  image.onload = function () {
                    var wScale = self.width / image.width;
                    var yScale = self.height / image.height;
                    //ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, image.width * wScale, image.height * yScale);
                    self.fillText(ctx, text);
                    resolve(canvas);
                  };
                });
              },
              resetBgColor() {
                this.ctx.fillStyle = this.bgColor;
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
              },
              btn_submit() {
                var self = this;
                let content = this.getElement('content');
                if (!content.value) {
                  return;
                }                
                if(al) {
                  alert('invaild input, please enter only characters');
                }
                
                const aList = content.value.split('');
                const rowSize = Math.ceil(aList.length / 10);
                const contentSplit = [];
            
                for (let i = 0; i < rowSize; i++) {
                  contentSplit.push(aList.splice(0, 10).join(''));
                }
            
                this.btn_clear();
                
                let splitList = [];
                contentSplit.forEach((item) => {
                  console.log('item:', item);
                  for (let i = 0; i < item.length; i++) {
                    splitList.push(self.drawImage(item[i]));
                    //splitList.push(self.fillText(item[i]));
                  }
                });
            
                Promise.all(splitList).then(function (img) {
                  let len = 0;
                  contentSplit.forEach(function (item, index) {
                    if (index) {
                      len += contentSplit[index - 1].length;
                    }
                    for (let i = 0; i < item.length; i++) {
                      self.ctx.drawImage(img[i + len], i * 35 + 50, index * 55);
                    }
                  });
                });
              },
              btn_clear() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                this.resetBgColor();
                let content = this.getElement('content');
                content.value = '';
              },
              
              init() {
                var self = this;
                this.canvas = this.getElement('canvas');
                this.ctx = canvas.getContext('2d');
                var btn_submit = this.getElement('submit');
                var btn_clear = this.getElement('clear');
                btn_submit.onclick = function () {
                  self.btn_submit();
                };
                btn_clear.onclick = function () {
                  self.btn_clear();
                };
                this.resetBgColor();
                for (let i = 1; i <= 35; i++) {
                  this.images.push('./img/' + i + '.png');
                  // this.images.push('./img/1.png');
                }
              },
              
            }
            window.onload = function () {
              Wrapper.init();
            };
          </script>
          <!-- <script src="./app1.js"></script> -->
          
        </div>
      </section>

      <footer>
        <p>Updated: March 18th, 2022</p>
      </footer>

    </body>

  </html>
  

  
